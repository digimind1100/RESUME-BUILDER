<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" href="/favicon.ico" />

    <link id="resumeStyleLink" rel="stylesheet" href="/templates/template1.css" />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AI RESUME BUILDER</title>
  </head>

  <body>
    <div id="root"></div>
    <div id="modal-root"></div>

    <!-- =========================
         REVIEW POPUP
    ========================== -->
    <div id="reviewOverlay" class="review-overlay">
      <div class="review-modal">
        <button class="close-btn" onclick="closeReview()">✕</button>

        <h3>How was your experience?</h3>

        <input
          type="text"
          id="reviewName"
          placeholder="Your name (optional)"
        />

        <select id="reviewRating" class="rating-select">
  <option value="5" selected>★★★★★</option>
  <option value="4">★★★★☆</option>
  <option value="3">★★★☆☆</option>
  <option value="2">★★☆☆☆</option>
  <option value="1">★☆☆☆☆</option>
</select>


        <textarea
          id="reviewComment"
          placeholder="Write your feedback..."
        ></textarea>

        <button class="submit-btn" onclick="submitReview()">
          Submit Review
        </button>

        <p id="reviewMsg"></p>
      </div>
    </div>

    <!-- =========================
         REVIEW POPUP JS (GLOBAL)
    ========================== -->
    <script>
  function openReview() {
    const el = document.getElementById("reviewOverlay");
    if (el) el.classList.add("show");
  }

  function closeReview() {
    const el = document.getElementById("reviewOverlay");
    if (el) el.classList.remove("show");
  }

  function maybeOpenReviewPopup() {
    const isPremium = localStorage.getItem("isPremium") === "true";
    if (!isPremium) return;
    setTimeout(openReview, 1000);
  }

  async function submitReview() {
    const name = document.getElementById("reviewName").value.trim();
    const rating = document.getElementById("reviewRating").value;
    const comment = document.getElementById("reviewComment").value.trim();
    const msg = document.getElementById("reviewMsg");

    // basic validation
    if (!rating || !comment) {
      msg.innerText = "Please provide rating and feedback.";
      msg.style.color = "red";
      return;
    }

    msg.innerText = "Submitting review...";
    msg.style.color = "#333";

    try {
      const res = await fetch("https://resume-builder-backend.up.railway.app/api/reviews", {

        method: "POST",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify({
          name: name || "Anonymous",
          rating: Number(rating),
          comment,
        }),
      });

      const data = await res.json();

      if (!res.ok) {
        throw new Error(data.message || "Failed to submit review");
      }

      msg.innerText = "✅ Thanks! Your review is submitted for approval.";
      msg.style.color = "green";

      // reset fields
      document.getElementById("reviewName").value = "";
      document.getElementById("reviewComment").value = "";

      // auto-close popup
      setTimeout(closeReview, 1500);

    } catch (err) {
      console.error(err);
      msg.innerText = "❌ Unable to submit review. Please try again.";
      msg.style.color = "red";
    }
  }
</script>


    <!-- =========================
         REACT ENTRY
    ========================== -->
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
